<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.jpg"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta name="google-site-verification" content="INib61UyYabZlsc0LPzbi5O2qlux9S7YlcvrRdmFOmU"><meta name="msvalidate.01" content="A117C8AE0DF96AAEC2BC9D4914C0B404"><meta name="yandex-verification" content="2c7e88b2e774befb"><meta name="baidu-site-verification" content="codeva-Hhmgc2znuV"><meta name="360-site-verification" content="99dc35dba24d3316a5c4165a21d1c8b2"><meta name="sogou_site_verification" content="n0MrA7DawS"><meta name="bytedance-verification-code" content="T5+8Lbmr5HPdlA87vM/H"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"blog.xxin.xyz","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script><meta name="description" content="XX校园逆向破解，去除环境检测"><meta property="og:type" content="article"><meta property="og:title" content="记录一次逆向某校园软件"><meta property="og:url" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/index.html"><meta property="og:site_name" content="小信笔记"><meta property="og:description" content="XX校园逆向破解，去除环境检测"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img1.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img2.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img3.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img4.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img5.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img6.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img7.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img8.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img9.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img10.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img11.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img12.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img13.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img14.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img15.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img16.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img17.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img18.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img19.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img20.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img21.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img22.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img23.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img24.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img25.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img26.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img27.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img28.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img29.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img30.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img31.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img32.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img33.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img34.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img35.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img36.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img37.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img38.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img39.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img40.png"><meta property="og:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img41.png"><meta property="article:published_time" content="2021-11-05T05:45:25.000Z"><meta property="article:modified_time" content="2025-05-10T06:42:30.902Z"><meta property="article:author" content="xxin"><meta property="article:tag" content="Android逆向"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/img1.png"><link rel="canonical" href="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/","path":"2021/11/05/记录一次逆向某校园软件/","title":"记录一次逆向某校园软件"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>记录一次逆向某校园软件 | 小信笔记</title><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">小信笔记</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">逃避思考，热爱幻想</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%BB%E6%9B%B4%E6%96%B0"><span class="nav-number">1.</span> <span class="nav-text">去更新</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%99%BB%E5%BD%95%E6%8E%A5%E5%8F%A3"><span class="nav-number">2.</span> <span class="nav-text">修改登录接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87wi-fi%E6%A3%80%E6%B5%8B"><span class="nav-number">3.</span> <span class="nav-text">过wi-fi检测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87root%E6%A3%80%E6%B5%8B"><span class="nav-number">4.</span> <span class="nav-text">过root检测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A3%80%E6%B5%8B"><span class="nav-number">5.</span> <span class="nav-text">过虚拟机检测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9D%E8%A7%84%E6%97%B6%E4%B8%8D%E8%AE%B0%E5%BD%95"><span class="nav-number">6.</span> <span class="nav-text">违规时不记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%8735%E7%A7%92%E6%A3%80%E6%B5%8B"><span class="nav-number">7.</span> <span class="nav-text">过35秒检测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%9E%E6%B3%95%E8%AF%B7%E6%B1%82%E4%BF%AE%E5%A4%8D"><span class="nav-number">8.</span> <span class="nav-text">非法请求修复</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sign%E9%AA%8C%E7%AD%BE%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91"><span class="nav-number">9.</span> <span class="nav-text">sign验签算法逆向</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1%E7%89%88%E6%9C%AC%E5%89%8D"><span class="nav-number">9.1.</span> <span class="nav-text">2.2.1版本前</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%BD%8D%E5%85%B3%E9%94%AE%E8%AF%8D"><span class="nav-number">9.1.1.</span> <span class="nav-text">定位关键词</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E5%85%B3%E9%94%AE%E8%AF%8D%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">9.1.2.</span> <span class="nav-text">分析关键词调用方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90json%E5%8A%A0%E5%AF%86"><span class="nav-number">9.1.3.</span> <span class="nav-text">分析json加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90key%E5%80%BC%E8%8E%B7%E5%8F%96"><span class="nav-number">9.1.4.</span> <span class="nav-text">分析key值获取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90AES%E5%8A%A0%E5%AF%86"><span class="nav-number">9.1.5.</span> <span class="nav-text">分析AES加密</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0"><span class="nav-number">9.2.</span> <span class="nav-text">2.2.1版本更新</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90json%E5%8A%A0%E5%AF%86-1"><span class="nav-number">9.2.1.</span> <span class="nav-text">分析json加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90key%E5%80%BC%E8%8E%B7%E5%8F%96-1"><span class="nav-number">9.2.2.</span> <span class="nav-text">分析key值获取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90AES%E5%8A%A0%E5%AF%86-1"><span class="nav-number">9.2.3.</span> <span class="nav-text">分析AES加密</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="xxin" src="https://q1.qlogo.cn/g?b=qq&nk=3033528136&s=640"><p class="site-author-name" itemprop="name">xxin</p><div class="site-description" itemprop="description">路漫漫其修远兮，吾将上下而求索。</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">195</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">10</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">25</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/xxinPro" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xxinPro" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://wpa.qq.com/msgrd?v=3&uin=3033528136&site=qq&menu=yes" title="QQ → https:&#x2F;&#x2F;wpa.qq.com&#x2F;msgrd?v&#x3D;3&amp;uin&#x3D;3033528136&amp;site&#x3D;qq&amp;menu&#x3D;yes" rel="noopener me" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a> </span><span class="links-of-author-item"><a href="mailto:x@xxin.xyz" title="E-Mail → mailto:x@xxin.xyz" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.xxin.xyz/2021/11/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E9%80%86%E5%90%91%E6%9F%90%E6%A0%A1%E5%9B%AD%E8%BD%AF%E4%BB%B6/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://q1.qlogo.cn/g?b=qq&nk=3033528136&s=640"><meta itemprop="name" content="xxin"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="小信笔记"><meta itemprop="description" content="路漫漫其修远兮，吾将上下而求索。"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="记录一次逆向某校园软件 | 小信笔记"><meta itemprop="description" content="<center>XX校园逆向破解，去除环境检测</center>"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">记录一次逆向某校园软件</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-11-05 13:45:25" itemprop="dateCreated datePublished" datetime="2021-11-05T13:45:25+08:00">2021-11-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a> </span></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>11k</span></span></div><div class="post-description"><center>XX校园逆向破解，去除环境检测</center></div></div></header><div class="post-body" itemprop="articleBody"><p>&ensp;&ensp;&ensp;&ensp;教程仅供学习交流，学习研究软件设计思路，请勿用于任何非法用途</p><h2 id="去更新"><a href="#去更新" class="headerlink" title="去更新"></a>去更新</h2><p>&ensp;&ensp;&ensp;&ensp;在解包后的软件文件夹中，从smali代码中查找“1.2.0”，将其全部替换为9.9.9<br><img src="../记录一次逆向某校园软件/img1.png" width="70%" width="70%"><br><img src="../记录一次逆向某校园软件/img2.png" width="70%" width="70%"></p><h2 id="修改登录接口"><a href="#修改登录接口" class="headerlink" title="修改登录接口"></a>修改登录接口</h2><p>&ensp;&ensp;&ensp;&ensp;自v2版本更新后，v1版本的登录接口就无法登陆了，但是想开挂只能用v1，所以通过抓包拿到v2版本的登录接口替换给v1</p><p>&ensp;&ensp;&ensp;&ensp;抓包拿到v2的登录接口<br><img src="../记录一次逆向某校园软件/img3.png" width="40%" width="40%"></p><p>&ensp;&ensp;&ensp;&ensp;去除域名，得到剩余的接口地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run-front/account/login_v2</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;&ensp;&ensp;同理，再抓到v1版本的登录接口，将v1接口替换为v2即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// v1</span><br><span class="line">  run-front/account/login</span><br><span class="line">  </span><br><span class="line">// v2</span><br><span class="line">  run-front/account/login_v2</span><br></pre></td></tr></table></figure><p><img src="../记录一次逆向某校园软件/img4.png" width="70%" width="70%"><br><img src="../记录一次逆向某校园软件/img5.png" width="70%" width="70%"></p><h2 id="过wi-fi检测"><a href="#过wi-fi检测" class="headerlink" title="过wi-fi检测"></a>过wi-fi检测</h2><p>&ensp;&ensp;&ensp;&ensp;搜索关键词，并复制搜索到的关键词变量名<br><img src="../记录一次逆向某校园软件/img6.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;搜索变量名，查找调用处，在RunningSettingsActivity和GPSOptimizeActivity类中调用了该字符串<br><img src="../记录一次逆向某校园软件/img7.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;分析RunningSettingsActivity类中的代码<br><img src="../记录一次逆向某校园软件/img8.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;跳转到isForbiddenWiFi()方法所在的类，分析发现isForbiddenWiFi()返回this.forbiddenWiFi，而setForbiddenWiFi()给this.forbiddenWiFi赋值，只要在setForbiddenWiFi()方法中永远给this.forbiddenWiFi赋值为false就好了<br><img src="../记录一次逆向某校园软件/img9.png" width="70%" width="70%"></p><p><img src="../记录一次逆向某校园软件/img10.png" width="70%" width="70%"></p><h2 id="过root检测"><a href="#过root检测" class="headerlink" title="过root检测"></a>过root检测</h2><p>&ensp;&ensp;&ensp;&ensp;搜索关键词，并复制搜索到的关键词变量名，留意一下上边的cheat_warn_1到cheat_warn_5<br><img src="../记录一次逆向某校园软件/img11.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;搜索变量名cheat_warn_running，发现HomeActivity和RunningDetailActivity两个类调用了它，很可惜两个类都和过root检测没有直接关系，但是两个类中的代码可以确定，cheat_warn_running和cheat_warn_1到cheat_warn_5是有直接关系的，二者必定同时出现<br><img src="../记录一次逆向某校园软件/img12.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;通过第一部的搜索可知，cheat_warn_1 = “在root环境下使用闪动校园”，所以去到代码中搜索cheat_warn_1，发现SunshineRunningFragment类和FreeRunningFragment类也在调用它，把这两个类名翻译为中文，又刚好对应软件的“阳光跑”和“自由跑”<br><img src="../记录一次逆向某校园软件/img13.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;打开对应阳光跑的类看下，一目了然，而自由跑中除了没有wifi检测外，也一模一样<br><img src="../记录一次逆向某校园软件/img14.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;也就是说，只要RootDetectUtil.b().a()永远返回false，将不会检测root环境<br><img src="../记录一次逆向某校园软件/img15.png" width="70%" width="70%"></p><h2 id="过虚拟机检测"><a href="#过虚拟机检测" class="headerlink" title="过虚拟机检测"></a>过虚拟机检测</h2><p>&ensp;&ensp;&ensp;&ensp;有了上面的经验，过虚拟机检测就比较简单了，只要让这个判断不进入if代码块就好<br><img src="../记录一次逆向某校园软件/img16.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;在SunshineRunningFragment中加入一行const/4 v0, 0x0<br><img src="../记录一次逆向某校园软件/img17.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;同理，FreeRunningFragment中，但是之前的完成品中并没有过掉自由跑的虚拟机检测，因为我忘了<br><img src="../记录一次逆向某校园软件/img18.png" width="70%" width="70%"></p><h2 id="违规时不记录"><a href="#违规时不记录" class="headerlink" title="违规时不记录"></a>违规时不记录</h2><p>&ensp;&ensp;&ensp;&ensp;搜索字符串cheat_warn_running，在HomeActivity的onEvent方法中<br><img src="../记录一次逆向某校园软件/img19.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;使paramCheatStopEvent值为null，则不进入方法体<br><img src="../记录一次逆向某校园软件/img20.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;搜索字符串cheat_warn_running，在RunningDetailActivity的O方法中，使i = 0<br><img src="../记录一次逆向某校园软件/img21.png" width="70%" width="70%"></p><p><img src="../记录一次逆向某校园软件/img22.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;搜索字符串cheat_warn_1，在SunshineRunActivity类的e方法中<br><img src="../记录一次逆向某校园软件/img23.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;使schoolRule变量值为null<br><img src="../记录一次逆向某校园软件/img24.png" width="70%" width="70%"></p><h2 id="过35秒检测"><a href="#过35秒检测" class="headerlink" title="过35秒检测"></a>过35秒检测</h2><p>&ensp;&ensp;&ensp;&ensp;闪动校园在开始运动的第35秒必定会有一次检测，这里提供一个简单的解决思路</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">35s == 35000ms</span><br><span class="line">35000(10进制) == 88B8(16进制)</span><br><span class="line"></span><br><span class="line">1h == 3600s == 3600000ms</span><br><span class="line">3600000(10进制) == 36EE80(16进制)</span><br><span class="line"></span><br><span class="line">找到88B8修改为36EE80就好了</span><br></pre></td></tr></table></figure><p><img src="../记录一次逆向某校园软件/img25.png" width="70%" width="70%"></p><h2 id="非法请求修复"><a href="#非法请求修复" class="headerlink" title="非法请求修复"></a>非法请求修复</h2><p>&ensp;&ensp;&ensp;&ensp;2021年11月21日，官方在服务器添加了版本验证，其实具体是怎么个验证法我现在都搞不清，因为之前apk包中的版本号全部修改为9.9.9，所以请求数据时提交的json数据中也是9.9.9版本，此时接口将会返回“非法请求，验签不通过”并在app中Toast<br>&ensp;&ensp;&ensp;&ensp;所有的数据请求接口，包括但不限于：用户资料、学校阳光跑要求条件、学校自由跑要求条件，都被添加了这种验签，所以必须修复<br><img src="../记录一次逆向某校园软件/img26.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;我原以为要重构它的json拼接方式和解析方式，忙活了一天没有半点进展，误打误撞下，将其中一个版本号从9.9.9修改成了2.1.1(当前最新版本2.1.1)，成功了，惊喜之外<br><img src="../记录一次逆向某校园软件/img27.png" width="70%" width="70%"></p><h2 id="sign验签算法逆向"><a href="#sign验签算法逆向" class="headerlink" title="sign验签算法逆向"></a>sign验签算法逆向</h2><p>“非法请求，验签不通过”的原因：</p><ol><li>版本号超出当前最新版本版本号或版本号格式错误</li><li>post中的提交的json和sign值不对应，sign值由json加密获得</li><li>2.2.1版本前与2.2.1版本由于加密key不同所以得到的sign值不同，即服务器验证中json与sign不对应</li></ol><h3 id="2-2-1版本前"><a href="#2-2-1版本前" class="headerlink" title="2.2.1版本前"></a>2.2.1版本前</h3><h4 id="定位关键词"><a href="#定位关键词" class="headerlink" title="定位关键词"></a>定位关键词</h4><p>&ensp;&ensp;&ensp;&ensp;这里使用1.2.0版本演示<br>&ensp;&ensp;&ensp;&ensp;搜索关键词”sign”，1.2.0版本共有两处，在huachenjie.sdk.http.e包的b类a(K, B,Map)方法中出现了一次，将”sign”修改为”signs”，抓包会发现post中的sign响应头也变成了”signs”，所以可以猜测，a(K, B,Map)中调用的a(String, B, Map, String)添加了”sign”响应头和对应的sign值，那么它一定与sign值有关联<br><img src="../记录一次逆向某校园软件/img28.png" width="70%" width="70%"></p><h4 id="分析关键词调用方法"><a href="#分析关键词调用方法" class="headerlink" title="分析关键词调用方法"></a>分析关键词调用方法</h4><p>&ensp;&ensp;&ensp;&ensp;分析一下调用a(String, B, Map, String)方法传入的4个参数</p><p>&ensp;&ensp;&ensp;&ensp;1、String值”sign”: 不用多说，一个响应头的键名而已</p><p>&ensp;&ensp;&ensp;&ensp;2、B类型paramB: 该类中的String[]类型的a数组记录了所有的键名和键值，包括post中的sign等响应头的键值对，以及post的json中的键值对，B类的构造函数为其赋值，将一个集合转换为数组并赋值给a数组<br><img src="../记录一次逆向某校园软件/img29.png" width="70%" width="70%"><br>&ensp;&ensp;&ensp;&ensp;2.1、而集合的值来源于构造函数中传入的a类的a变量，a类是B.class文件中的一个内部类，它的a变量记录了一个String类型的集合，该集合作为post中所有数据的源头，该内部类中的b(String,String)方法为其题添加值，b(String)方法为其删除值<br><img src="../记录一次逆向某校园软件/img30.png" width="70%" width="70%"><br><img src="../记录一次逆向某校园软件/img31.png" width="70%" width="70%"><br>&ensp;&ensp;&ensp;&ensp;2.2、总而言之，传入B类的最大作用就是可以通过它调用post中所有的数据</p><p>&ensp;&ensp;&ensp;&ensp;3、强转为Map类型的hashMap: 在当前方法中刚创建的，主要用于记录sign的值，当前方法被调用时return出去</p><p>&ensp;&ensp;&ensp;&ensp;4、b(paramMap): 通过添加Log，Map类型的paramMap转为String后竟然是post提交的json值，那么有极大可能b(Map)方法返回的String字符串就是sign值</p><h4 id="分析json加密"><a href="#分析json加密" class="headerlink" title="分析json加密"></a>分析json加密</h4><p>&ensp;&ensp;&ensp;&ensp;将传入的Map转换成了String赋值给str，这个str就是post中的json值，str传入了f类的b(String)方法<br><img src="../记录一次逆向某校园软件/img32.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;f类的b(String)将传入的json值提交给a(String,String)方法，一并提交的还有”SHA-256”，能看出来对json值进行了一次SHA-256加密<br><img src="../记录一次逆向某校园软件/img33.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;跳转到a(String,String)方法，果然先经历了一次SHA-256加密，开始我还以为是base64<br>&ensp;&ensp;&ensp;&ensp;具体代码如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">f</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">a</span><span class="params">(String paramString)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">MessageDigest</span> <span class="variable">messageDigest</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;md5&quot;</span>);</span><br><span class="line">      messageDigest.update(paramString.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">      <span class="type">byte</span>[] arrayOfByte = messageDigest.digest();</span><br><span class="line">      <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">      <span class="built_in">this</span>(arrayOfByte.length * <span class="number">2</span>);</span><br><span class="line">      <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> arrayOfByte.length;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>; b &lt; i; b++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> arrayOfByte[b] &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="keyword">if</span> (j &lt; <span class="number">16</span>)</span><br><span class="line">          stringBuilder.append(<span class="string">&quot;0&quot;</span>); </span><br><span class="line">        stringBuilder.append(Integer.toHexString(j));</span><br><span class="line">      &#125; </span><br><span class="line">      <span class="keyword">return</span> stringBuilder.toString();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException noSuchAlgorithmException) &#123;</span><br><span class="line">      noSuchAlgorithmException.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception exception) &#123;</span><br><span class="line">      exception.printStackTrace();</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">a</span><span class="params">(String paramString1, String paramString2)</span> &#123;</span><br><span class="line">    String str1;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">bool</span> <span class="operator">=</span> TextUtils.isEmpty(paramString1);</span><br><span class="line">    <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (bool)</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">MessageDigest</span> <span class="variable">messageDigest</span> <span class="operator">=</span> MessageDigest.getInstance(paramString2);</span><br><span class="line">      messageDigest.update(paramString1.getBytes());</span><br><span class="line">      <span class="type">byte</span>[] arrayOfByte = messageDigest.digest();</span><br><span class="line">      <span class="type">StringBuffer</span> <span class="variable">stringBuffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">      <span class="built_in">this</span>();</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>; b &lt; arrayOfByte.length; b++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> Integer.toHexString(arrayOfByte[b] &amp; <span class="number">0xFF</span>);</span><br><span class="line">        <span class="keyword">if</span> (str.length() == <span class="number">1</span>)</span><br><span class="line">          stringBuffer.append(<span class="string">&#x27;0&#x27;</span>); </span><br><span class="line">        stringBuffer.append(str);</span><br><span class="line">      &#125; </span><br><span class="line">      str1 = stringBuffer.toString();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException noSuchAlgorithmException) &#123;</span><br><span class="line">      noSuchAlgorithmException.printStackTrace();</span><br><span class="line">      str1 = str2;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> str1;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">b</span><span class="params">(String paramString)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a(paramString, <span class="string">&quot;SHA-256&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;&ensp;&ensp;根据这个加密代码编写一个用例测试一下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  拟定json数据</span></span><br><span class="line">  <span class="type">String</span> <span class="variable">json_content</span> <span class="operator">=</span> <span class="string">&quot;&#123;&quot;</span>appCode<span class="string">&quot;:&quot;</span>SD001<span class="string">&quot;,&quot;</span>appVersion<span class="string">&quot;:&quot;</span><span class="number">1.2</span><span class="number">.0</span><span class="string">&quot;,&quot;</span>buildVersion<span class="string">&quot;:&quot;</span><span class="number">13</span><span class="string">&quot;,&quot;</span>deviceId<span class="string">&quot;:&quot;</span>ffffffff-ffff-ffff-ffff-ffffffffffffffffffff-ffff-ffff-ffff-ffffffffffff<span class="string">&quot;,&quot;</span>modelName<span class="string">&quot;:&quot;</span>Phone|test <span class="number">1</span><span class="string">&quot;,&quot;</span>platform<span class="string">&quot;:&quot;</span><span class="number">2</span><span class="string">&quot;,&quot;</span>systemVersion<span class="string">&quot;:&quot;</span><span class="number">11</span><span class="string">&quot;,&quot;</span>timestamp<span class="string">&quot;:&quot;</span><span class="number">1637652538168</span><span class="string">&quot;,&quot;</span>userId<span class="string">&quot;:&quot;</span><span class="number">201225</span>*****<span class="number">661220</span><span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line"><span class="comment">//  加密方式</span></span><br><span class="line">  <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;SHA-256&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  SHA-256加密</span></span><br><span class="line">  <span class="keyword">private</span> String <span class="title function_">SHA256Encryption</span><span class="params">()</span> &#123;</span><br><span class="line">      String value;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="type">MessageDigest</span> <span class="variable">messageDigest</span> <span class="operator">=</span>MessageDigest.getInstance(type);<span class="comment">//SHA-256类型</span></span><br><span class="line">          messageDigest.update(json_content.getBytes());<span class="comment">//取json数据的byte</span></span><br><span class="line">          <span class="type">byte</span>[] arrayOfBy = messageDigest.digest();</span><br><span class="line">          <span class="type">StringBuffer</span> <span class="variable">stringBuffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arrayOfBy.length; i++) &#123;</span><br><span class="line">              <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span>Integer.toHexString(arrayOfBy[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">              <span class="keyword">if</span> (str.length() == <span class="number">1</span>)&#123;</span><br><span class="line">                  stringBuffer.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">              stringBuffer.append(str);</span><br><span class="line">          &#125;</span><br><span class="line">          value = stringBuffer.toString();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          value = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;&ensp;&ensp;得到加密值，但是并不是最终值，那说明还有一步加密，肯定就在刚刚f.b(String)作为参数的a.b(String,String)方法中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3f5711c7f2e4880579fc0f2286c1578b031087ccd86d8af099fdfc40d1697db4</span><br></pre></td></tr></table></figure><h4 id="分析key值获取"><a href="#分析key值获取" class="headerlink" title="分析key值获取"></a>分析key值获取</h4><p>&ensp;&ensp;&ensp;&ensp;现在已知，f.b(String)就是SHA-256加密后的json值，在a.b(String,String)中还有一次加密，想要弄明白a.b(String,String)，先来分析传入的第二个参数a.a()<br>&ensp;&ensp;&ensp;&ensp;解知，a.a()方法返回一个字符串，字符串源自其静态a方法中的第一个参数，图中有一个错误。上面的箭头应该指向b变量却指向了d变量<br><img src="../记录一次逆向某校园软件/img34.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;通过查找知，b的值为F44B0282BEA83557，在某些特殊情况下为huachenjie(不需要考虑)</p><h4 id="分析AES加密"><a href="#分析AES加密" class="headerlink" title="分析AES加密"></a>分析AES加密</h4><p>&ensp;&ensp;&ensp;&ensp;现已知，f.b(String)是SHA-256加密后的json值，a.a()返回一个不长的字符串，盲猜是加密key<br>&ensp;&ensp;&ensp;&ensp;现在来分析a.b(String,String)，豁，好家伙了，AES加密，怪不得那么像base64<br><img src="../记录一次逆向某校园软件/img35.png" width="70%" width="70%"><br>&ensp;&ensp;&ensp;&ensp;其中调用的一个变量和一个方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  <span class="built_in">this</span>(a.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"><span class="comment">//  a的值为</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> <span class="string">&quot;01234ABCDEF56789&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> b.a(cipher.doFinal(paramString1.getBytes(<span class="string">&quot;UTF-8&quot;</span>)));</span><br><span class="line"><span class="comment">//  b.a()方法为</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">a</span><span class="params">(<span class="type">byte</span>[] paramArrayOfbyte)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (paramArrayOfbyte != <span class="literal">null</span>) &#123;</span><br><span class="line">      String str1;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>();</span><br><span class="line">        <span class="built_in">this</span>(Base64.encode(paramArrayOfbyte, <span class="number">2</span>), <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        str1 = str2;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (UnsupportedEncodingException unsupportedEncodingException) &#123;</span><br><span class="line">        unsupportedEncodingException.printStackTrace();</span><br><span class="line">        str1 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">      &#125; </span><br><span class="line">      <span class="keyword">return</span> str1;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;&ensp;&ensp;编写用例，调试成功😊</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  调试代码就不贴了</span></span><br></pre></td></tr></table></figure><h3 id="2-2-1版本更新"><a href="#2-2-1版本更新" class="headerlink" title="2.2.1版本更新"></a>2.2.1版本更新</h3><p>&ensp;&ensp;&ensp;&ensp;当前的最新版本了，不确定以后会不会在这个基础上作出修改<br>&ensp;&ensp;&ensp;&ensp;定位关键词、分析调用方法这些都是一样的，从SHA-256加密json值和获取key值开始说</p><h4 id="分析json加密-1"><a href="#分析json加密-1" class="headerlink" title="分析json加密"></a>分析json加密</h4><p>&ensp;&ensp;&ensp;&ensp;相对于1.2.0有所变动，但是无伤大雅，依然可以直接抄</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">f</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">a</span><span class="params">(String paramString1, String paramString2)</span> &#123;</span><br><span class="line">    String str1;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">bool</span> <span class="operator">=</span> TextUtils.isEmpty(paramString1);</span><br><span class="line">    <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (bool)</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="type">String</span> <span class="variable">str3</span> <span class="operator">=</span> str2;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">MessageDigest</span> <span class="variable">messageDigest</span> <span class="operator">=</span> MessageDigest.getInstance(paramString2);</span><br><span class="line">      str3 = str2;</span><br><span class="line">      messageDigest.update(paramString1.getBytes());</span><br><span class="line">      str3 = str2;</span><br><span class="line">      <span class="type">byte</span>[] arrayOfByte = messageDigest.digest();</span><br><span class="line">      str3 = str2;</span><br><span class="line">      <span class="type">StringBuffer</span> <span class="variable">stringBuffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">      str3 = str2;</span><br><span class="line">      <span class="built_in">this</span>();</span><br><span class="line">      <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        str3 = str2;</span><br><span class="line">        <span class="keyword">if</span> (b &lt; arrayOfByte.length) &#123;</span><br><span class="line">          str3 = str2;</span><br><span class="line">          <span class="type">String</span> <span class="variable">str4</span> <span class="operator">=</span> Integer.toHexString(arrayOfByte[b] &amp; <span class="number">0xFF</span>);</span><br><span class="line">          str3 = str2;</span><br><span class="line">          <span class="keyword">if</span> (str4.length() == <span class="number">1</span>) &#123;</span><br><span class="line">            str3 = str2;</span><br><span class="line">            stringBuffer.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">          &#125; </span><br><span class="line">          str3 = str2;</span><br><span class="line">          stringBuffer.append(str4);</span><br><span class="line">          b++;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        str3 = str2;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> stringBuffer.toString();</span><br><span class="line">        str3 = str;</span><br><span class="line">        str1 = str;</span><br><span class="line">        <span class="keyword">if</span> (str.length() &gt;= <span class="number">16</span>) &#123;</span><br><span class="line">          str3 = str;</span><br><span class="line">          <span class="type">String</span> <span class="variable">str4</span> <span class="operator">=</span> str.substring(<span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">          str3 = str;</span><br><span class="line">          str2 = str.substring(str.length() - <span class="number">8</span>);</span><br><span class="line">          str3 = str;</span><br><span class="line">          <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">          str3 = str;</span><br><span class="line">          <span class="built_in">this</span>();</span><br><span class="line">          str3 = str;</span><br><span class="line">          stringBuilder.append(str2);</span><br><span class="line">          str3 = str;</span><br><span class="line">          stringBuilder.append(str.substring(<span class="number">8</span>, str.length() - <span class="number">8</span>));</span><br><span class="line">          str3 = str;</span><br><span class="line">          stringBuilder.append(str4);</span><br><span class="line">          str3 = str;</span><br><span class="line">          str1 = stringBuilder.toString();</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> str1;</span><br><span class="line">      &#125; </span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException noSuchAlgorithmException) &#123;</span><br><span class="line">      noSuchAlgorithmException.printStackTrace();</span><br><span class="line">      str1 = str3;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> str1;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">b</span><span class="params">(String paramString)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">MessageDigest</span> <span class="variable">messageDigest</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;md5&quot;</span>);</span><br><span class="line">      messageDigest.update(paramString.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">      <span class="type">byte</span>[] arrayOfByte = messageDigest.digest();</span><br><span class="line">      <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">      <span class="built_in">this</span>(arrayOfByte.length * <span class="number">2</span>);</span><br><span class="line">      <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> arrayOfByte.length;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>; b &lt; i; b++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> arrayOfByte[b] &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="keyword">if</span> (j &lt; <span class="number">16</span>)</span><br><span class="line">          stringBuilder.append(<span class="string">&quot;0&quot;</span>); </span><br><span class="line">        stringBuilder.append(Integer.toHexString(j));</span><br><span class="line">      &#125; </span><br><span class="line">      <span class="keyword">return</span> stringBuilder.toString();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException noSuchAlgorithmException) &#123;</span><br><span class="line">      noSuchAlgorithmException.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception exception) &#123;</span><br><span class="line">      exception.printStackTrace();</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">c</span><span class="params">(String paramString)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a(paramString, <span class="string">&quot;SHA-256&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="分析key值获取-1"><a href="#分析key值获取-1" class="headerlink" title="分析key值获取"></a>分析key值获取</h4><p>&ensp;&ensp;&ensp;&ensp;解知，a.c()方法返回一个字符串，字符串源自其静态d方法中的第二个参数，从1.2.0的第一个参数转变成了第二个<br><img src="../记录一次逆向某校园软件/img36.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;这里就他妈比较烦人了槽<br>&ensp;&ensp;&ensp;&ensp;通过查找知，key值来源于com.huachenjie.shandong_school包中ShandongApplication类c()方法中huachenjie.sdk.http.k.a.a.d(str3, str1, “”, false, false, arrayList)的第二个变量str1<br><img src="../记录一次逆向某校园软件/img37.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;而str1来源于e()方法，e()方法返回的k.b2s(byte[], int)中就是key值了。如果删除了他们定义的那张图片，那么bitmip就为null，这个方法就会像1.2.0那样返回F44B0282BEA83557，结局就是验签失败<br><img src="../记录一次逆向某校园软件/img38.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;跳转到b2s，是个native方法🙂<br><img src="../记录一次逆向某校园软件/img39.png" width="70%" width="70%"></p><p>&ensp;&ensp;&ensp;&ensp;而我，看不懂so文件里的汇编🙂<br><img src="../记录一次逆向某校园软件/img40.png" width="70%" width="70%"></p><h4 id="分析AES加密-1"><a href="#分析AES加密-1" class="headerlink" title="分析AES加密"></a>分析AES加密</h4><p>&ensp;&ensp;&ensp;&ensp;没变，不分析了<br><img src="../记录一次逆向某校园软件/img41.png" width="70%" width="70%"></p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Android%E9%80%86%E5%90%91/" rel="tag"><i class="fa fa-tag"></i> Android逆向</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2021/11/04/Android%E5%AE%9E%E6%88%98-%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82-4/" rel="prev" title="Android实战-智慧城市(4)"><i class="fa fa-angle-left"></i> Android实战-智慧城市(4)</a></div><div class="post-nav-item"><a href="/2021/11/05/%E9%97%AA%E4%B8%8D%E5%8A%A8%E6%A0%A1%E5%9B%AD/" rel="next" title="闪不动校园">闪不动校园 <i class="fa fa-angle-right"></i></a></div></div></footer></article></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">鲁ICP备19064654号-5</a></div><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">xxin</span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdn.bootcdn.net/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script src="/js/third-party/fancybox.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/js/third-party/math/mathjax.js"></script></body></html>